---
---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: druidclusters.druid.stackable.tech
  annotations:
    helm.sh/resource-policy: keep
spec:
  group: druid.stackable.tech
  names:
    categories: []
    kind: DruidCluster
    plural: druidclusters
    shortNames:
      - druid
    singular: druidcluster
  scope: Namespaced
  versions:
    - additionalPrinterColumns: []
      name: v1alpha1
      schema:
        openAPIV3Schema:
          description: "Auto-generated derived type for DruidClusterSpec via `CustomResource`"
          properties:
            spec:
              properties:
                brokers:
                  properties:
                    cliOverrides:
                      additionalProperties:
                        type: string
                      default: {}
                      type: object
                    config:
                      default: {}
                      type: object
                    configOverrides:
                      additionalProperties:
                        additionalProperties:
                          type: string
                        type: object
                      default: {}
                      type: object
                    envOverrides:
                      additionalProperties:
                        type: string
                      default: {}
                      type: object
                    roleGroups:
                      additionalProperties:
                        properties:
                          cliOverrides:
                            additionalProperties:
                              type: string
                            default: {}
                            type: object
                          config:
                            default: {}
                            type: object
                          configOverrides:
                            additionalProperties:
                              additionalProperties:
                                type: string
                              type: object
                            default: {}
                            type: object
                          envOverrides:
                            additionalProperties:
                              type: string
                            default: {}
                            type: object
                          replicas:
                            format: uint16
                            minimum: 0.0
                            nullable: true
                            type: integer
                          selector:
                            description: A label selector is a label query over a set of resources. The result of matchLabels and matchExpressions are ANDed. An empty label selector matches all objects. A null label selector matches no objects.
                            nullable: true
                            properties:
                              matchExpressions:
                                description: matchExpressions is a list of label selector requirements. The requirements are ANDed.
                                items:
                                  description: "A label selector requirement is a selector that contains values, a key, and an operator that relates the key and values."
                                  properties:
                                    key:
                                      description: key is the label key that the selector applies to.
                                      type: string
                                    operator:
                                      description: "operator represents a key's relationship to a set of values. Valid operators are In, NotIn, Exists and DoesNotExist."
                                      type: string
                                    values:
                                      description: "values is an array of string values. If the operator is In or NotIn, the values array must be non-empty. If the operator is Exists or DoesNotExist, the values array must be empty. This array is replaced during a strategic merge patch."
                                      items:
                                        type: string
                                      type: array
                                  required:
                                    - key
                                    - operator
                                  type: object
                                type: array
                              matchLabels:
                                additionalProperties:
                                  type: string
                                description: "matchLabels is a map of {key,value} pairs. A single {key,value} in the matchLabels map is equivalent to an element of matchExpressions, whose key field is \"key\", the operator is \"In\", and the values array contains only \"value\". The requirements are ANDed."
                                type: object
                            type: object
                        type: object
                      type: object
                  required:
                    - roleGroups
                  type: object
                coordinators:
                  properties:
                    cliOverrides:
                      additionalProperties:
                        type: string
                      default: {}
                      type: object
                    config:
                      default: {}
                      type: object
                    configOverrides:
                      additionalProperties:
                        additionalProperties:
                          type: string
                        type: object
                      default: {}
                      type: object
                    envOverrides:
                      additionalProperties:
                        type: string
                      default: {}
                      type: object
                    roleGroups:
                      additionalProperties:
                        properties:
                          cliOverrides:
                            additionalProperties:
                              type: string
                            default: {}
                            type: object
                          config:
                            default: {}
                            type: object
                          configOverrides:
                            additionalProperties:
                              additionalProperties:
                                type: string
                              type: object
                            default: {}
                            type: object
                          envOverrides:
                            additionalProperties:
                              type: string
                            default: {}
                            type: object
                          replicas:
                            format: uint16
                            minimum: 0.0
                            nullable: true
                            type: integer
                          selector:
                            description: A label selector is a label query over a set of resources. The result of matchLabels and matchExpressions are ANDed. An empty label selector matches all objects. A null label selector matches no objects.
                            nullable: true
                            properties:
                              matchExpressions:
                                description: matchExpressions is a list of label selector requirements. The requirements are ANDed.
                                items:
                                  description: "A label selector requirement is a selector that contains values, a key, and an operator that relates the key and values."
                                  properties:
                                    key:
                                      description: key is the label key that the selector applies to.
                                      type: string
                                    operator:
                                      description: "operator represents a key's relationship to a set of values. Valid operators are In, NotIn, Exists and DoesNotExist."
                                      type: string
                                    values:
                                      description: "values is an array of string values. If the operator is In or NotIn, the values array must be non-empty. If the operator is Exists or DoesNotExist, the values array must be empty. This array is replaced during a strategic merge patch."
                                      items:
                                        type: string
                                      type: array
                                  required:
                                    - key
                                    - operator
                                  type: object
                                type: array
                              matchLabels:
                                additionalProperties:
                                  type: string
                                description: "matchLabels is a map of {key,value} pairs. A single {key,value} in the matchLabels map is equivalent to an element of matchExpressions, whose key field is \"key\", the operator is \"In\", and the values array contains only \"value\". The requirements are ANDed."
                                type: object
                            type: object
                        type: object
                      type: object
                  required:
                    - roleGroups
                  type: object
                deepStorage:
                  oneOf:
                    - required:
                        - hdfs
                    - required:
                        - s3
                  properties:
                    hdfs:
                      properties:
                        configMapName:
                          type: string
                        storageDirectory:
                          type: string
                      required:
                        - configMapName
                        - storageDirectory
                      type: object
                    s3:
                      properties:
                        baseKey:
                          nullable: true
                          type: string
                        bucket:
                          description: Operators are expected to define fields for this type in order to work with S3 buckets.
                          oneOf:
                            - required:
                                - inline
                            - required:
                                - reference
                          properties:
                            inline:
                              description: S3 bucket specification containing only the bucket name and an inlined or referenced connection specification.
                              properties:
                                bucketName:
                                  nullable: true
                                  type: string
                                connection:
                                  description: Operators are expected to define fields for this type in order to work with S3 connections.
                                  nullable: true
                                  oneOf:
                                    - required:
                                        - inline
                                    - required:
                                        - reference
                                  properties:
                                    inline:
                                      description: S3 connection definition as CRD.
                                      properties:
                                        accessStyle:
                                          description: "Which access style to use. Defaults to virtual hosted-style as most of the data products out there. Have a look at the official documentation on <https://docs.aws.amazon.com/AmazonS3/latest/userguide/VirtualHosting.html>"
                                          enum:
                                            - Path
                                            - VirtualHosted
                                          nullable: true
                                          type: string
                                        credentials:
                                          description: "If the S3 uses authentication you have to specify you S3 credentials. In the most cases a SecretClass providing `accessKey` and `secretKey` is sufficient."
                                          nullable: true
                                          properties:
                                            scope:
                                              description: "[Scope](https://docs.stackable.tech/secret-operator/scope.html) of the [SecretClass](https://docs.stackable.tech/secret-operator/secretclass.html)"
                                              nullable: true
                                              properties:
                                                node:
                                                  default: false
                                                  type: boolean
                                                pod:
                                                  default: false
                                                  type: boolean
                                                services:
                                                  default: []
                                                  items:
                                                    type: string
                                                  type: array
                                              type: object
                                            secretClass:
                                              description: "[SecretClass](https://docs.stackable.tech/secret-operator/secretclass.html) containing the LDAP bind credentials"
                                              type: string
                                          required:
                                            - secretClass
                                          type: object
                                        host:
                                          description: Hostname of the S3 server without any protocol or port
                                          nullable: true
                                          type: string
                                        port:
                                          description: Port the S3 server listens on. If not specified the products will determine the port to use.
                                          format: uint16
                                          minimum: 0.0
                                          nullable: true
                                          type: integer
                                        tls:
                                          description: If you want to use TLS when talking to S3 you can enable TLS encrypted communication with this setting.
                                          nullable: true
                                          properties:
                                            verification:
                                              description: The verification method used to verify the certificates of the server and/or the client
                                              oneOf:
                                                - required:
                                                    - none
                                                - required:
                                                    - server
                                              properties:
                                                none:
                                                  description: "Use TLS but don't verify certificates"
                                                  type: object
                                                server:
                                                  description: Use TLS and ca certificate to verify the server
                                                  properties:
                                                    caCert:
                                                      description: Ca cert to verify the server
                                                      oneOf:
                                                        - required:
                                                            - webPki
                                                        - required:
                                                            - secretClass
                                                      properties:
                                                        secretClass:
                                                          description: "Name of the SecretClass which will provide the ca cert. Note that a SecretClass does not need to have a key but can also work with just a ca cert. So if you got provided with a ca cert but don't have access to the key you can still use this method."
                                                          type: string
                                                        webPki:
                                                          description: Use TLS and the ca certificates trusted by the common web browsers to verify the server. This can be useful when you e.g. use public AWS S3 or other public available services.
                                                          type: object
                                                      type: object
                                                  required:
                                                    - caCert
                                                  type: object
                                              type: object
                                          required:
                                            - verification
                                          type: object
                                      type: object
                                    reference:
                                      type: string
                                  type: object
                              type: object
                            reference:
                              type: string
                          type: object
                      required:
                        - bucket
                      type: object
                  type: object
                historicals:
                  properties:
                    cliOverrides:
                      additionalProperties:
                        type: string
                      default: {}
                      type: object
                    config:
                      default: {}
                      type: object
                    configOverrides:
                      additionalProperties:
                        additionalProperties:
                          type: string
                        type: object
                      default: {}
                      type: object
                    envOverrides:
                      additionalProperties:
                        type: string
                      default: {}
                      type: object
                    roleGroups:
                      additionalProperties:
                        properties:
                          cliOverrides:
                            additionalProperties:
                              type: string
                            default: {}
                            type: object
                          config:
                            default: {}
                            type: object
                          configOverrides:
                            additionalProperties:
                              additionalProperties:
                                type: string
                              type: object
                            default: {}
                            type: object
                          envOverrides:
                            additionalProperties:
                              type: string
                            default: {}
                            type: object
                          replicas:
                            format: uint16
                            minimum: 0.0
                            nullable: true
                            type: integer
                          selector:
                            description: A label selector is a label query over a set of resources. The result of matchLabels and matchExpressions are ANDed. An empty label selector matches all objects. A null label selector matches no objects.
                            nullable: true
                            properties:
                              matchExpressions:
                                description: matchExpressions is a list of label selector requirements. The requirements are ANDed.
                                items:
                                  description: "A label selector requirement is a selector that contains values, a key, and an operator that relates the key and values."
                                  properties:
                                    key:
                                      description: key is the label key that the selector applies to.
                                      type: string
                                    operator:
                                      description: "operator represents a key's relationship to a set of values. Valid operators are In, NotIn, Exists and DoesNotExist."
                                      type: string
                                    values:
                                      description: "values is an array of string values. If the operator is In or NotIn, the values array must be non-empty. If the operator is Exists or DoesNotExist, the values array must be empty. This array is replaced during a strategic merge patch."
                                      items:
                                        type: string
                                      type: array
                                  required:
                                    - key
                                    - operator
                                  type: object
                                type: array
                              matchLabels:
                                additionalProperties:
                                  type: string
                                description: "matchLabels is a map of {key,value} pairs. A single {key,value} in the matchLabels map is equivalent to an element of matchExpressions, whose key field is \"key\", the operator is \"In\", and the values array contains only \"value\". The requirements are ANDed."
                                type: object
                            type: object
                        type: object
                      type: object
                  required:
                    - roleGroups
                  type: object
                ingestion:
                  nullable: true
                  properties:
                    s3connection:
                      description: Operators are expected to define fields for this type in order to work with S3 connections.
                      nullable: true
                      oneOf:
                        - required:
                            - inline
                        - required:
                            - reference
                      properties:
                        inline:
                          description: S3 connection definition as CRD.
                          properties:
                            accessStyle:
                              description: "Which access style to use. Defaults to virtual hosted-style as most of the data products out there. Have a look at the official documentation on <https://docs.aws.amazon.com/AmazonS3/latest/userguide/VirtualHosting.html>"
                              enum:
                                - Path
                                - VirtualHosted
                              nullable: true
                              type: string
                            credentials:
                              description: "If the S3 uses authentication you have to specify you S3 credentials. In the most cases a SecretClass providing `accessKey` and `secretKey` is sufficient."
                              nullable: true
                              properties:
                                scope:
                                  description: "[Scope](https://docs.stackable.tech/secret-operator/scope.html) of the [SecretClass](https://docs.stackable.tech/secret-operator/secretclass.html)"
                                  nullable: true
                                  properties:
                                    node:
                                      default: false
                                      type: boolean
                                    pod:
                                      default: false
                                      type: boolean
                                    services:
                                      default: []
                                      items:
                                        type: string
                                      type: array
                                  type: object
                                secretClass:
                                  description: "[SecretClass](https://docs.stackable.tech/secret-operator/secretclass.html) containing the LDAP bind credentials"
                                  type: string
                              required:
                                - secretClass
                              type: object
                            host:
                              description: Hostname of the S3 server without any protocol or port
                              nullable: true
                              type: string
                            port:
                              description: Port the S3 server listens on. If not specified the products will determine the port to use.
                              format: uint16
                              minimum: 0.0
                              nullable: true
                              type: integer
                            tls:
                              description: If you want to use TLS when talking to S3 you can enable TLS encrypted communication with this setting.
                              nullable: true
                              properties:
                                verification:
                                  description: The verification method used to verify the certificates of the server and/or the client
                                  oneOf:
                                    - required:
                                        - none
                                    - required:
                                        - server
                                  properties:
                                    none:
                                      description: "Use TLS but don't verify certificates"
                                      type: object
                                    server:
                                      description: Use TLS and ca certificate to verify the server
                                      properties:
                                        caCert:
                                          description: Ca cert to verify the server
                                          oneOf:
                                            - required:
                                                - webPki
                                            - required:
                                                - secretClass
                                          properties:
                                            secretClass:
                                              description: "Name of the SecretClass which will provide the ca cert. Note that a SecretClass does not need to have a key but can also work with just a ca cert. So if you got provided with a ca cert but don't have access to the key you can still use this method."
                                              type: string
                                            webPki:
                                              description: Use TLS and the ca certificates trusted by the common web browsers to verify the server. This can be useful when you e.g. use public AWS S3 or other public available services.
                                              type: object
                                          type: object
                                      required:
                                        - caCert
                                      type: object
                                  type: object
                              required:
                                - verification
                              type: object
                          type: object
                        reference:
                          type: string
                      type: object
                  type: object
                metadataStorageDatabase:
                  properties:
                    connString:
                      type: string
                    dbType:
                      enum:
                        - derby
                        - mysql
                        - postgresql
                      type: string
                    host:
                      type: string
                    password:
                      nullable: true
                      type: string
                    port:
                      format: uint16
                      minimum: 0.0
                      type: integer
                    user:
                      nullable: true
                      type: string
                  required:
                    - connString
                    - dbType
                    - host
                    - port
                  type: object
                middleManagers:
                  properties:
                    cliOverrides:
                      additionalProperties:
                        type: string
                      default: {}
                      type: object
                    config:
                      default: {}
                      type: object
                    configOverrides:
                      additionalProperties:
                        additionalProperties:
                          type: string
                        type: object
                      default: {}
                      type: object
                    envOverrides:
                      additionalProperties:
                        type: string
                      default: {}
                      type: object
                    roleGroups:
                      additionalProperties:
                        properties:
                          cliOverrides:
                            additionalProperties:
                              type: string
                            default: {}
                            type: object
                          config:
                            default: {}
                            type: object
                          configOverrides:
                            additionalProperties:
                              additionalProperties:
                                type: string
                              type: object
                            default: {}
                            type: object
                          envOverrides:
                            additionalProperties:
                              type: string
                            default: {}
                            type: object
                          replicas:
                            format: uint16
                            minimum: 0.0
                            nullable: true
                            type: integer
                          selector:
                            description: A label selector is a label query over a set of resources. The result of matchLabels and matchExpressions are ANDed. An empty label selector matches all objects. A null label selector matches no objects.
                            nullable: true
                            properties:
                              matchExpressions:
                                description: matchExpressions is a list of label selector requirements. The requirements are ANDed.
                                items:
                                  description: "A label selector requirement is a selector that contains values, a key, and an operator that relates the key and values."
                                  properties:
                                    key:
                                      description: key is the label key that the selector applies to.
                                      type: string
                                    operator:
                                      description: "operator represents a key's relationship to a set of values. Valid operators are In, NotIn, Exists and DoesNotExist."
                                      type: string
                                    values:
                                      description: "values is an array of string values. If the operator is In or NotIn, the values array must be non-empty. If the operator is Exists or DoesNotExist, the values array must be empty. This array is replaced during a strategic merge patch."
                                      items:
                                        type: string
                                      type: array
                                  required:
                                    - key
                                    - operator
                                  type: object
                                type: array
                              matchLabels:
                                additionalProperties:
                                  type: string
                                description: "matchLabels is a map of {key,value} pairs. A single {key,value} in the matchLabels map is equivalent to an element of matchExpressions, whose key field is \"key\", the operator is \"In\", and the values array contains only \"value\". The requirements are ANDed."
                                type: object
                            type: object
                        type: object
                      type: object
                  required:
                    - roleGroups
                  type: object
                opa:
                  nullable: true
                  properties:
                    configMapName:
                      type: string
                    package:
                      nullable: true
                      type: string
                  required:
                    - configMapName
                  type: object
                routers:
                  properties:
                    cliOverrides:
                      additionalProperties:
                        type: string
                      default: {}
                      type: object
                    config:
                      default: {}
                      type: object
                    configOverrides:
                      additionalProperties:
                        additionalProperties:
                          type: string
                        type: object
                      default: {}
                      type: object
                    envOverrides:
                      additionalProperties:
                        type: string
                      default: {}
                      type: object
                    roleGroups:
                      additionalProperties:
                        properties:
                          cliOverrides:
                            additionalProperties:
                              type: string
                            default: {}
                            type: object
                          config:
                            default: {}
                            type: object
                          configOverrides:
                            additionalProperties:
                              additionalProperties:
                                type: string
                              type: object
                            default: {}
                            type: object
                          envOverrides:
                            additionalProperties:
                              type: string
                            default: {}
                            type: object
                          replicas:
                            format: uint16
                            minimum: 0.0
                            nullable: true
                            type: integer
                          selector:
                            description: A label selector is a label query over a set of resources. The result of matchLabels and matchExpressions are ANDed. An empty label selector matches all objects. A null label selector matches no objects.
                            nullable: true
                            properties:
                              matchExpressions:
                                description: matchExpressions is a list of label selector requirements. The requirements are ANDed.
                                items:
                                  description: "A label selector requirement is a selector that contains values, a key, and an operator that relates the key and values."
                                  properties:
                                    key:
                                      description: key is the label key that the selector applies to.
                                      type: string
                                    operator:
                                      description: "operator represents a key's relationship to a set of values. Valid operators are In, NotIn, Exists and DoesNotExist."
                                      type: string
                                    values:
                                      description: "values is an array of string values. If the operator is In or NotIn, the values array must be non-empty. If the operator is Exists or DoesNotExist, the values array must be empty. This array is replaced during a strategic merge patch."
                                      items:
                                        type: string
                                      type: array
                                  required:
                                    - key
                                    - operator
                                  type: object
                                type: array
                              matchLabels:
                                additionalProperties:
                                  type: string
                                description: "matchLabels is a map of {key,value} pairs. A single {key,value} in the matchLabels map is equivalent to an element of matchExpressions, whose key field is \"key\", the operator is \"In\", and the values array contains only \"value\". The requirements are ANDed."
                                type: object
                            type: object
                        type: object
                      type: object
                  required:
                    - roleGroups
                  type: object
                stopped:
                  description: "Emergency stop button, if `true` then all pods are stopped without affecting configuration (as setting `replicas` to `0` would)"
                  nullable: true
                  type: boolean
                version:
                  description: Desired Druid version
                  type: string
                zookeeperConfigMapName:
                  type: string
              required:
                - brokers
                - coordinators
                - deepStorage
                - historicals
                - metadataStorageDatabase
                - middleManagers
                - routers
                - version
                - zookeeperConfigMapName
              type: object
            status:
              nullable: true
              type: object
          required:
            - spec
          title: DruidCluster
          type: object
      served: true
      storage: true
      subresources:
        status: {}
