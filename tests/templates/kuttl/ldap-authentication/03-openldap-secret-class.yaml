---
apiVersion: kuttl.dev/v1beta1
kind: TestStep
metadata:
  name: openldap
commands:
  # SecretClass requires an explicit namespace to work
  - script: |
      kubectl apply -n $NAMESPACE -f - <<EOF
      ---
      apiVersion: secrets.stackable.tech/v1alpha1
      kind: SecretClass
      metadata:
        name: openldap-tls
      spec:
        backend:
          autoTls:
            ca:
              autoGenerate: true
              secret:
                name: openldap-tls-ca
                namespace: $NAMESPACE
      EOF
